plugins {
    id 'java'
}


java {
    sourceCompatibility = JavaVersion.VERSION_1_8
    targetCompatibility = JavaVersion.VERSION_1_8
}

ext {
    // По умолчанию используем v155 (замените на нужный тег: v126, release-v8 и т.д.)
    mindustryVersion = project.hasProperty('mindustryVersion') ? project.property('mindustryVersion') : 'v155'
    arcVersion = project.hasProperty('arcVersion') ? project.property('arcVersion') : mindustryVersion
}

repositories {
    mavenCentral()
    maven { url 'https://jitpack.io' }
}

dependencies {
    // Не бандлим движок — только для компиляции
    compileOnly "com.github.Anuken.Mindustry:core:${mindustryVersion}"
    compileOnly "com.github.Anuken.Arc:arc-core:${arcVersion}"

    // Пример: если нужны утилиты, добавьте их как implementation/compileOnly
    // implementation 'org.some:lib:1.2.3'
}

tasks.withType(JavaCompile) {
    options.encoding = 'UTF-8'
}

jar {
    // Обычный мод-jar: не бандлим движок
    archiveFileName = "${project.name}.jar"
    manifest {
        attributes(
            'Implementation-Title': project.name,
            'Implementation-Version': project.version
        )
    }
}

task deploy(type: Copy) {
    dependsOn jar
    from("$buildDir/libs") {
        include '*.jar'
    }
    def targetDir = project.hasProperty('modsDir') ? project.property('modsDir') : "${buildDir}/deploy"
    into targetDir
    doLast {
        println "Deployed to: ${targetDir}"
    }
}

